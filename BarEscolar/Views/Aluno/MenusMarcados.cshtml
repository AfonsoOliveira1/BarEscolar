@model IEnumerable<BarEscolar.Models.OrderItem>

@{
    ViewData["Title"] = "Menus Marcados";
    var allMenus = ViewBag.AllMenus as List<BarEscolar.Models.MenuDay>;
}

<h1 class="marcados-title">Menus Marcados — @ViewBag.User.FullName</h1>

<a asp-action="Index" asp-route-id="@ViewBag.User.ID" class="btn btn-primary mt-3">
    Voltar aos Menus
</a>


@if (!Model.Any())
{
    <p class="marcados-empty">Não existem menus marcados.</p>
}
else
{
    <div class="marcados-table-wrapper">
        <table class="marcados-table">
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Prato Principal</th>
                    <th>Tipo</th>
                    <th>Sobremesa</th>
                    <th>Sopa</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    var menu = allMenus.FirstOrDefault(m => m.Id == item.Productid);
                    if (menu != null)
                    {
                        <tr>
                            <td>@menu.Date.ToShortDateString()</td>
                            <td>@menu.MainDish</td>
                            <td>@(menu.option == "A" ? "Não-Vegan" : "Vegan")</td>
                            <td>@menu.Dessert</td>
                            <td>@menu.Soup</td>
                            <td>
                                <form asp-action="CancelarMarcacao" method="post">
                                    <input type="hidden" name="id" value="@ViewBag.User.ID" />
                                    <input type="hidden" name="orderItemId" value="@item.Id" />
                                    <button type="submit" class="btn marcados-cancel-btn">Cancelar</button>
                                </form>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
}
